import{r as y,o as E,e as o,f as x,g as te,j as l,k as e,l as V,m as U,v as T,b as oe,F as $,q as b,u as O,t as N,x as v,y as k,z as q,c as R,w as le,A as ne,B as ie}from"./vue-D74OEr_Y.js";import{u as A,a as ae,c as re,b as ce}from"./router-CCRAkHEr.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))h(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&h(i)}).observe(document,{childList:!0,subtree:!0});function u(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function h(t){if(t.ep)return;t.ep=!0;const n=u(t);fetch(t.href,n)}})();const D=y(""),I=y(!1),de=y(!1);function ue(r){D.value=r,I.value=!0}function pe(){D.value="",I.value=!1}function me(){try{localStorage.removeItem("username"),localStorage.removeItem("userInfo")}catch{}D.value="",I.value=!1}const _e={username:D,isLoggedIn:I,isInitialized:de,setUsername:ue,clearUser:pe,initUser:me};function z(){return _e}const ve={class:"app"},he={__name:"App",setup(r){const c=z();return E(()=>{c.initUser()}),(u,h)=>{const t=te("router-view");return l(),o("div",ve,[x(t)])}}},C=(r,c)=>{const u=r.__vccOpts||r;for(const[h,t]of c)u[h]=t;return u},fe={class:"login-container"},ge={class:"login-form"},ye={class:"form-group"},ke={__name:"LoginForm",setup(r){const c=A(),u=z(),h=y(""),t=()=>{h.value.trim()&&(u.setUsername(h.value.trim()),c.push("/topics"))};return(n,i)=>(l(),o("div",fe,[e("div",ge,[i[3]||(i[3]=e("h1",{class:"login-title"},"æ¬¢è¿æ¥åˆ°æˆ‘ä»¬çš„äº’åŠ¨ç•™è¨€æ¿",-1)),i[4]||(i[4]=e("p",{class:"login-subtitle"},"è¯·è¾“å…¥æ‚¨çš„å§“åå¼€å§‹æ¢ç´¢",-1)),e("form",{onSubmit:V(t,["prevent"])},[e("div",ye,[i[1]||(i[1]=e("label",{for:"username"},"æ‚¨çš„å§“åï¼š",-1)),U(e("input",{type:"text",id:"username","onUpdate:modelValue":i[0]||(i[0]=f=>h.value=f),required:"",placeholder:"è¯·è¾“å…¥æ‚¨çš„å§“å",maxlength:"20"},null,512),[[T,h.value]])]),i[2]||(i[2]=e("button",{type:"submit",class:"login-button"},"è¿›å…¥ç•™è¨€æ¿",-1))],32)])]))}},$e=C(ke,[["__scopeId","data-v-5a7bf959"]]),be={class:"login-view"},we={__name:"LoginView",setup(r){return(c,u)=>(l(),o("div",be,[x($e)]))}},Me=C(we,[["__scopeId","data-v-9f2ce891"]]),L=y([{id:"1",name:"åšæ¸¸æˆ",color:"#E74C3C",icon:"ğŸ®"},{id:"2",name:"å’¨è¯¢å®¶",color:"#3498DB",icon:"ğŸ’¡"},{id:"3",name:"åœä¸€åœ",color:"#2ECC71",icon:"â¸ï¸"},{id:"4",name:"è‹±é›„æ¦œ",color:"#F39C12",icon:"ğŸ†"},{id:"5",name:"ä¼‘æ¯å§",color:"#9B59B6",icon:"ğŸ˜´"},{id:"6",name:"å¼€å°å·®",color:"#1ABC9C",icon:"ğŸ’­"},{id:"7",name:"å½“è€å¸ˆ",color:"#D35400",icon:"ğŸ‘¨â€ğŸ«"},{id:"8",name:"æ–°ç©ºé—´",color:"#34495E",icon:"ğŸŒŒ"},{id:"9",name:"å°å‰§åœº",color:"#E67E22",icon:"ğŸ­"}]),w=oe({1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[]});function Ce(){return L.value}function Se(r){return L.value.find(c=>c.id===r)}function Ue(r){return w[r]||[]}function xe(r,c){w[r]||(w[r]=[]),w[r].unshift({...c,timestamp:new Date().toISOString()})}function Te(r,c){w[r]&&(w[r]=w[r].filter(u=>u.id!==c))}function De(r){const c={id:Date.now().toString(),...r};return L.value.push(c),w[c.id]=[],c}function B(){return{topics:L,topicMessages:w,getAllTopics:Ce,getTopicById:Se,getTopicMessages:Ue,addMessage:xe,deleteMessage:Te,addTopic:De}}const Ie={class:"topics-view"},Le={class:"counter-wrapper"},Ve={class:"counter-bg"},Ae={class:"topics-grid"},Be=["onClick"],Fe={class:"film-holes film-holes-top"},Pe={class:"film-holes film-holes-bottom"},Ze={class:"film-inner"},Oe={class:"film-header"},Ee={class:"film-icon"},Ne={class:"film-label"},qe={class:"film-body"},Re={class:"film-frame"},ze={class:"film-frame-window"},He={class:"film-frame-left"},We={class:"film-name"},Ke={class:"film-frame-right"},Ye={class:"film-count"},Ge={__name:"TopicsView",setup(r){const c=A(),u=B(),h=t=>{c.push(`/topic/${t}`)};return(t,n)=>(l(),o("div",Ie,[n[5]||(n[5]=e("div",{class:"header"},[e("h1",{class:"page-title"},"é€‰æ‹©ä¸€å·èƒ¶å·ï¼Œèµ°è¿›ä¸€ä¸ªå°ä¸–ç•Œ")],-1)),e("div",Le,[e("div",Ve,[n[2]||(n[2]=e("div",{class:"shelf shelf-row-1"},null,-1)),n[3]||(n[3]=e("div",{class:"shelf shelf-row-2"},null,-1)),n[4]||(n[4]=e("div",{class:"shelf shelf-row-3"},null,-1)),e("div",Ae,[(l(!0),o($,null,b(O(u).getAllTopics(),i=>(l(),o("div",{key:i.id,class:"topic-card film-roll",style:N({"--edge-color":i.color}),onClick:f=>h(i.id)},[e("div",Fe,[(l(),o($,null,b(10,f=>e("span",{key:"t-"+f,class:"hole"})),64))]),e("div",Pe,[(l(),o($,null,b(10,f=>e("span",{key:"b-"+f,class:"hole"})),64))]),e("div",Ze,[e("div",Oe,[e("span",Ee,v(i.icon),1),e("span",Ne,"FILM "+v(i.id),1)]),e("div",qe,[e("div",Re,[e("div",ze,[e("div",He,[e("div",We,v(i.name),1),n[0]||(n[0]=e("div",{class:"film-highlight"},null,-1))]),e("div",Ke,[e("div",Ye,v(O(u).getTopicMessages(i.id).length)+" æ¡ç•™è¨€ ",1)])])])])]),n[1]||(n[1]=e("div",{class:"film-shadow"},null,-1))],12,Be))),128))])])])]))}},Je=C(Ge,[["__scopeId","data-v-962968b0"]]),Qe={class:"message-form"},Xe={class:"username-input-container"},je={key:0,class:"no-username-warning"},es={class:"form-footer"},ss=["disabled"],ts={__name:"MessageForm",props:{topicId:{type:String,required:!0}},emits:["message-added"],setup(r,{emit:c}){const u=r,h=c,t=y(""),n=y(""),i=B(),f=()=>{if(console.log("æäº¤ç•™è¨€:",{content:t.value,username:n.value}),!t.value.trim()){console.log("ç•™è¨€å†…å®¹ä¸ºç©º");return}const p=n.value.trim();if(!p){console.log("ç”¨æˆ·åä¸ºç©ºå­—ç¬¦ä¸²");return}const m={id:Date.now().toString(),content:t.value.trim(),username:p};i.addMessage(u.topicId,m),console.log("ç•™è¨€æ·»åŠ æˆåŠŸ:",m),t.value="",h("message-added")};return(p,m)=>(l(),o("div",Qe,[m[3]||(m[3]=e("h3",{class:"form-title"},"å†™ä¸‹ä½ çš„ç•™è¨€ï¼š",-1)),e("div",Xe,[m[2]||(m[2]=e("label",{for:"username"},"æ‚¨çš„ç§°å‘¼ï¼š",-1)),U(e("input",{id:"username","onUpdate:modelValue":m[0]||(m[0]=g=>n.value=g),type:"text",placeholder:"è¯·è¾“å…¥æ‚¨çš„ç§°å‘¼",maxlength:"20",class:"username-input",autocomplete:"off"},null,512),[[T,n.value]])]),n.value.trim()?k("",!0):(l(),o("div",je," è¯·å…ˆè¾“å…¥æ‚¨çš„ç§°å‘¼æ‰èƒ½å‘è¡¨ç•™è¨€ ")),e("form",{onSubmit:V(f,["prevent"])},[U(e("textarea",{"onUpdate:modelValue":m[1]||(m[1]=g=>t.value=g),placeholder:"è¯·è¾“å…¥ä½ çš„ç•™è¨€...",rows:"4",required:"",maxlength:"500"},null,512),[[T,t.value]]),e("div",es,[e("span",{class:q(["char-count",{warning:t.value.length>450}])},v(t.value.length)+"/500 ",3),e("button",{type:"submit",class:"submit-btn",disabled:!t.value.trim()||!n.value.trim()}," å‘é€ç•™è¨€ ",8,ss)])],32)]))}},os=C(ts,[["__scopeId","data-v-cf51d48d"]]),ls={class:"message-list"},ns={key:0,class:"empty-state"},is={key:1,class:"messages"},as={class:"message-inner"},rs={class:"message-header"},cs={class:"message-username"},ds={class:"message-time"},us={class:"message-content"},ps={class:"message-actions"},ms=["onClick"],_s={__name:"MessageList",props:{messages:{type:Array,required:!0}},emits:["message-deleted"],setup(r,{emit:c}){const u=r,h=c,t=R(()=>[...u.messages].sort((f,p)=>new Date(p.timestamp)-new Date(f.timestamp))),n=f=>{const p=new Date(f),g=new Date-p;return g<60*1e3?"åˆšåˆš":g<3600*1e3?`${Math.floor(g/(60*1e3))}åˆ†é’Ÿå‰`:g<1440*60*1e3?`${Math.floor(g/(3600*1e3))}å°æ—¶å‰`:g<10080*60*1e3?`${Math.floor(g/(1440*60*1e3))}å¤©å‰`:`${p.getFullYear()}-${String(p.getMonth()+1).padStart(2,"0")}-${String(p.getDate()).padStart(2,"0")}`},i=f=>{confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡ç•™è¨€å—ï¼Ÿ")&&h("message-deleted",f)};return(f,p)=>(l(),o("div",ls,[p[1]||(p[1]=e("h3",{class:"list-title"},"ç•™è¨€ç¬”è®°æœ¬ï¼š",-1)),r.messages.length===0?(l(),o("div",ns,[...p[0]||(p[0]=[e("div",{class:"empty-icon"},"ğŸ’¬",-1),e("p",{class:"empty-text"},"æš‚æ— ç•™è¨€ï¼Œå¿«æ¥å‘å¸ƒç¬¬ä¸€æ¡ç•™è¨€å§ï¼",-1)])])):(l(),o("div",is,[(l(!0),o($,null,b(t.value,m=>(l(),o("div",{key:m.id,class:"message-item notebook-line"},[e("div",as,[e("div",rs,[e("span",cs,v(m.username),1),e("span",ds,v(n(m.timestamp)),1)]),e("div",us,v(m.content),1),e("div",ps,[e("button",{class:"delete-btn",onClick:g=>i(m.id),title:"åˆ é™¤ç•™è¨€"}," ğŸ—‘ï¸ ",8,ms)])])]))),128))]))]))}},vs=C(_s,[["__scopeId","data-v-6c25111e"]]),hs={class:"topic-detail-view"},fs={class:"container"},gs={class:"header"},ys={class:"topic-icon"},ks={class:"topic-title"},$s={class:"message-count"},bs={class:"photo-wall"},ws={class:"photo-grid"},Ms=["onClick"],Cs={class:"photo-image"},Ss=["src"],Us={key:1,class:"photo-placeholder"},xs={class:"photo-label"},Ts={class:"zone-index"},Ds={class:"zone-title"},Is={class:"content"},Ls={class:"polaroid-section"},Vs={key:0,class:"polaroid-empty"},As={class:"polaroid-list"},Bs={class:"polaroid-photo"},Fs={class:"polaroid-photo-inner"},Ps=["src"],Zs={key:1,class:"polaroid-upload-area"},Os=["onChange"],Es={class:"polaroid-upload-text"},Ns={key:0,class:"polaroid-sticker"},qs={key:1},Rs={key:2,class:"polaroid-sticker-overlay"},zs=["onUpdate:modelValue"],Hs={class:"polaroid-tools"},Ws={class:"polaroid-tools-row"},Ks={class:"sticker-picker"},Ys=["onClick"],Gs=["onClick"],Js={key:0,class:"share-section"},Qs=["onUpdate:modelValue"],Xs=["value"],js=["disabled","onClick"],et={class:"message-form-container notebook-form"},st={class:"messages-container notebook-messages"},tt={class:"modal-header"},ot={key:0,class:"modal-count"},lt={key:0,class:"modal-empty"},nt={class:"modal-polaroids-list"},it={class:"modal-polaroid-photo"},at=["src"],rt={key:1,class:"modal-sticker-overlay"},ct={key:0,class:"modal-polaroid-text"},dt={__name:"TopicDetailView",setup(r){const c=A(),u=ae(),h=B(),t=y(""),n=y({id:"",name:"åŠ è½½ä¸­...",icon:"â³",color:"#95a5a6"}),i=y([{title:"æ—¥å¸¸ç¢ç‰‡",image:null,uploadedImage:null,polaroids:[]},{title:"å°å°å¿ƒæ„¿",image:null,uploadedImage:null,polaroids:[]},{title:"è¯¾å ‚è®°å¿†",image:null,uploadedImage:null,polaroids:[]},{title:"æ²»æ„ˆç¬é—´",image:null,uploadedImage:null,polaroids:[]}]),f=y(!1),p=y([]),m=y("");let g=0;const S=y([]),K=y(["ğŸ˜€","ğŸ¥°","â­","ğŸŒ¸","ğŸˆ","ğŸŒ™"]),F=R(()=>h.getTopicMessages(t.value)),P=()=>{const _=u.params.id;if(!_){c.push("/topics");return}t.value=_;const a=h.getTopicById(_);a?n.value=a:c.push("/topics")},Y=()=>{console.log("ç•™è¨€å·²æ·»åŠ ")},G=()=>{g+=1,S.value.unshift({id:g,text:"",sticker:"",photo:null,photoUrl:null,selectedZone:""})},J=_=>{S.value=S.value.filter(a=>a.id!==_)},Q=(_,a)=>{const s=_.target.files[0];if(s&&s.type.startsWith("image/")){const d=new FileReader;d.onload=M=>{a.photo=s,a.photoUrl=M.target.result},d.readAsDataURL(s)}},X=(_,a)=>{if(_.photoUrl&&a!==null&&a!==void 0&&a!==""){const s=parseInt(a);if(!isNaN(s)&&s>=0&&s<i.value.length){const d={photoUrl:_.photoUrl,text:_.text,sticker:_.sticker,timestamp:new Date().toISOString()};i.value[s].polaroids.push(d),i.value[s].uploadedImage=_.photoUrl,alert(`ç…§ç‰‡å·²åˆ†äº«åˆ°ã€Œ${i.value[s].title}ã€`),_.selectedZone=""}}},j=_=>{const a=i.value[_];a.polaroids&&a.polaroids.length>0&&(p.value=a.polaroids,m.value=a.title,f.value=!0)},Z=()=>{f.value=!1,p.value=[],m.value=""},ee=_=>{h.deleteMessage(t.value,_)},se=()=>{c.push("/topics")};return E(()=>{P()}),u.params.id&&le(()=>u.params.id,_=>{_&&P()}),(_,a)=>(l(),o("div",hs,[e("div",fs,[e("div",gs,[e("button",{class:"back-btn",onClick:se},"â† è¿”å›è¯é¢˜åˆ—è¡¨"),e("div",{class:"topic-info",style:N({"--accent-color":n.value.color})},[e("div",ys,v(n.value.icon),1),e("h1",ks,v(n.value.name),1),e("p",$s,v(F.value.length)+" æ¡ç•™è¨€",1)],4)]),e("section",bs,[a[3]||(a[3]=e("div",{class:"rope"},null,-1)),e("div",ws,[(l(!0),o($,null,b(i.value,(s,d)=>(l(),o("div",{key:d,class:q(["photo-card",{"has-polaroid":s.polaroids&&s.polaroids.length>0}]),onClick:M=>j(d)},[a[2]||(a[2]=e("div",{class:"clip"},null,-1)),e("div",Cs,[s.uploadedImage?(l(),o("img",{key:0,src:s.uploadedImage,alt:"ä¸Šä¼ çš„ç…§ç‰‡",class:"photo-uploaded-img"},null,8,Ss)):(l(),o("div",Us,[...a[1]||(a[1]=[e("span",{class:"placeholder-text"},"å¾…ä¸Šä¼ ",-1)])]))]),e("div",xs,[e("span",Ts,"#"+v(d+1),1),e("span",Ds,v(s.title),1)])],10,Ms))),128))])]),e("div",Is,[e("section",Ls,[a[7]||(a[7]=e("div",{class:"polaroid-header"},[e("h2",null,"æ‹ç«‹å¾—äº’åŠ¨åŒº"),e("p",null,"ç‚¹å‡»ã€Œæ‹ä¸€å¼ ã€ï¼Œç”Ÿæˆä½ çš„ä¸“å±æ‹ç«‹å¾—å°å¡ç‰‡ï¼Œå¯ä»¥è´´è¡¨æƒ…è´´çº¸ã€å†™ä¸‹æƒ³è¯´çš„è¯ã€‚")],-1)),e("button",{class:"polaroid-btn",onClick:G},"ğŸ“¸ æ‹ä¸€å¼ "),S.value.length===0?(l(),o("div",Vs," è¿˜æ²¡æœ‰æ‹ç«‹å¾—å“¦ï¼Œç‚¹å‡»ä¸Šé¢çš„æŒ‰é’®æ‹ä¸€å¼ å§ï½ ")):k("",!0),e("div",As,[(l(!0),o($,null,b(S.value,s=>(l(),o("div",{key:s.id,class:"polaroid-card"},[e("div",Bs,[e("div",Fs,[s.photoUrl?(l(),o("img",{key:0,src:s.photoUrl,alt:"ä¸Šä¼ çš„ç…§ç‰‡",class:"polaroid-uploaded-image"},null,8,Ps)):(l(),o("div",Zs,[e("input",{type:"file",accept:"image/*",class:"polaroid-file-input",onChange:d=>Q(d,s)},null,40,Os),e("span",Es,[s.sticker?(l(),o("span",Ns,v(s.sticker),1)):(l(),o("span",qs,"ğŸ“· ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡"))])])),s.sticker&&s.photoUrl?(l(),o("span",Rs,v(s.sticker),1)):k("",!0)])]),U(e("textarea",{"onUpdate:modelValue":d=>s.text=d,class:"polaroid-text",rows:"2",placeholder:"åœ¨è¿™é‡Œå†™ä¸‹ä¸€å¥æƒ³è¯´çš„è¯..."},null,8,zs),[[T,s.text]]),e("div",Hs,[e("div",Ws,[e("div",Ks,[a[4]||(a[4]=e("span",{class:"sticker-label"},"è´´çº¸ï¼š",-1)),(l(!0),o($,null,b(K.value,d=>(l(),o("button",{key:d,type:"button",class:"sticker-btn",onClick:M=>s.sticker=d},v(d),9,Ys))),128))]),e("button",{type:"button",class:"polaroid-remove",onClick:d=>J(s.id)}," åˆ é™¤ ",8,Gs)]),s.photoUrl?(l(),o("div",Js,[a[6]||(a[6]=e("span",{class:"share-label"},"åˆ†äº«åˆ°ï¼š",-1)),U(e("select",{"onUpdate:modelValue":d=>s.selectedZone=d,class:"zone-select"},[a[5]||(a[5]=e("option",{value:""},"é€‰æ‹©åˆ†åŒº",-1)),(l(!0),o($,null,b(i.value,(d,M)=>(l(),o("option",{key:M,value:M},v(d.title),9,Xs))),128))],8,Qs),[[ne,s.selectedZone]]),e("button",{type:"button",class:"share-btn",disabled:s.selectedZone===""||s.selectedZone===null,onClick:d=>X(s,s.selectedZone)}," åˆ†äº« ",8,js)])):k("",!0)])]))),128))])]),e("div",et,[x(os,{"topic-id":t.value,onMessageAdded:Y},null,8,["topic-id"])]),e("div",st,[x(vs,{messages:F.value,onMessageDeleted:ee},null,8,["messages"])])])]),f.value?(l(),o("div",{key:0,class:"polaroid-modal-overlay",onClick:Z},[e("div",{class:"polaroid-modal-content",onClick:a[0]||(a[0]=V(()=>{},["stop"]))},[e("button",{class:"modal-close-btn",onClick:Z},"Ã—"),e("div",tt,[e("h3",null,v(m.value),1),p.value.length>0?(l(),o("p",ot," å…± "+v(p.value.length)+" å¼ æ‹ç«‹å¾— ",1)):k("",!0)]),p.value.length===0?(l(),o("div",lt," è¯¥åˆ†åŒºè¿˜æ²¡æœ‰æ‹ç«‹å¾— ")):k("",!0),e("div",nt,[(l(!0),o($,null,b(p.value,(s,d)=>(l(),o("div",{key:d,class:"modal-polaroid-card"},[e("div",it,[s.photoUrl?(l(),o("img",{key:0,src:s.photoUrl,alt:"æ‹ç«‹å¾—ç…§ç‰‡",class:"modal-photo-img"},null,8,at)):k("",!0),s.sticker?(l(),o("span",rt,v(s.sticker),1)):k("",!0)]),s.text?(l(),o("div",ct,v(s.text),1)):k("",!0)]))),128))])])])):k("",!0)]))}},ut=C(dt,[["__scopeId","data-v-d49518e1"]]),pt=[{path:"/",redirect:"/topics"},{path:"/login",name:"Login",component:Me},{path:"/topics",name:"Topics",component:Je},{path:"/topic/:id",name:"TopicDetail",component:ut,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",redirect:"/topics"}],H=re({history:ce(),routes:pt});H.beforeEach((r,c,u)=>{u()});const W=ie(he);W.use(H);W.mount("#app");
